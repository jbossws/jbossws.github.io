<!DOCTYPE html>
<html>
    <head>
   <META HTTP-EQUIV='Content-Security-Policy'
         CONTENT="default-src 'none'; object-src 'none'; style-src 'self' https://static.jboss.org ; script-src 'self' https://static.jboss.org ; font-src 'none'; img-src 'self' https://static.jboss.org; base-uri 'none'; form-action 'none'; frame-ancestors 'none' "/>
   <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
   <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
   <meta name="keywords" content="JBoss Web Services"/>
   <meta name="description" content=""/>
   <meta name="author" content=""/>
   <meta name="robots" content="all"/>
   <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8"/>

   <title>JBoss Web Services - JBoss Community</title>

   <link rel="stylesheet" type="text/css" href="https://static.jboss.org/theme/css/magnolia/clearspace_common.css" media="screen, projection" />
   <link rel="stylesheet" type="text/css" href="https://static.jboss.org/theme/css/magnolia/stkdefault-styles.css" media="screen, projection" />
   <link rel="stylesheet" type="text/css" href="https://static.jboss.org/theme/css/common/org_common.css" media="screen, projection" />
   <link rel="stylesheet" type="text/css" href="https://static.jboss.org/css/magnolia/styles.css" media="screen, projection" />
   <link rel="stylesheet" type="text/css" href="https://static.jboss.org/theme/css/magnolia/jquery-ui.css" media="screen, projection" />
   <link rel="stylesheet" type="text/css" href="https://static.jboss.org/theme/css/magnolia/project.css" media="screen, projection" />
   <link rel="stylesheet" type="text/css" href="https://static.jboss.org/theme/css/magnolia/wide.css" media="only screen and (min-width: 1200px)" />
   <link rel="stylesheet" type="text/css" href="https://static.jboss.org/css/jbossdeveloper-thin.css" media="screen, projection" />
   <link rel="stylesheet" type="text/css" href="https://static.jboss.org/css/rhbar.css" media="screen, projection" />
</head>

    <body id="project" class="col-float3 rightcol-layout">
    <div id="rhbar">
   <a class="jbdevlogo" href="https://developers.redhat.com"></a>
   <a class="rhlogo" href="https://www.redhat.com/"></a>
</div>

<div id="wrapper">
   <div id="maincontent-wrapper">

      <div id="top_subnav_branding">
         <div id="banner">

            <div style="z-index: 999; position: absolute; top: 0px; height:15px;">
            </div>

            <div id="projectname">
               JBoss Web Services
            </div>

            <div id="tagline">Web Services Framework for WildFly</div>

         </div>

         <div id="proj_announce">
            <div id="proj_logo"><h2>JBoss WS</h2></div>
            <div id="proj_tagline"><h3>Web Services Framework for WildFly</h3></div>
         </div>

         <div id="proj_nav" class="">
            <ul class="sf-menu">

               <li class="current">
                  <span class="notch">&nbsp;</span>
                  <a href="/index.html" class="menu-title">Overview</a>
               </li>

               <li class="open">
                  <span class="notch">&nbsp;</span>
                  <a href="/downloads" class="menu-title">Downloads</a>
                  <ul class="level1">
                     <li class="leaf"><a href="/downloads-latest"> Latest</a></li>
                     <li class="leaf"><a href="/downloads-4x"> 4.x</a></li>
                     <li class="leaf"><a href="/downloads-3x"> 3.x</a></li>
                  </ul>
               </li>

               <li class="open">
                  <span class="notch">&nbsp;</span>
                  <a href="/docs" class="menu-title">Documentation</a>
               </li>

               <li class="open">
                  <span class="notch">&nbsp;</span>
                  <a href="/blogs" class="menu-title">Blog</a>
               </li>

               <li class="open">
                  <span class="notch">&nbsp;</span>
                  <a href="/community" class="menu-title">Community</a>
               </li>

               <li class="open">
                  <span class="notch">&nbsp;</span>
                  <a href="https://issues.redhat.com/projects/JBWS/issues" class="menu-title">Issue Tracker</a>
                  <ul class="level1 jiralink">
                     <li class="leaf"><a href="https://issues.redhat.com/projects/JBWS/issues">JIRA</a></li>
                  </ul>
               </li>

               <li class="open">
                  <span class="notch">&nbsp;</span>
                  <a href="/sourcecode" class="menu-title">Source Code</a>
                  <ul class="level1">
                     <li class="leaf"><a href="https://github.com/jbossws">GitHub</a></li>
                  </ul>
               </li>

               <li id="buildmenu" class="open">
                  <span class="notch">&nbsp;</span>
                  <a href="/build" class="menu-title">Build</a>
               </li>
            </ul>
         </div>

      </div>
          <div id="wrapper-2">
         <div id="wrap-content">
            <div id="wrapper-3">
               <div id="main-wrapper">
                  <div id="main">
                     <div id="breadcrumb">
                       <span>
                              <a href="/">JBossWS</a>
                                &gt;
                              <a href="/blogs">Blogs</a>
                                &gt;
                              <a href="#">Migrating sources to GitHub</a>
                       </span>
                     </div><!-- end breadcrumb -->
                     <h3>Migrating sources to GitHub</h3>
                     <h5>By JBossWS Team | June 26, 2015</h5>
                     <p></p>
                     <p>I've been asked multiple times why the <em>JBossWS</em> project sources were still hosted on a <em>Subversion</em> repository. I've also had to put up with the complaints on time-consuming checkouts and even a bit of mockery from someone for not having migrated to <em>Git</em> yet…</p>

<p>Anyway, last week I had some quiet days, got the inspiration and started the migration… so now the <em>JBossWS</em> sources are eventually hosted on <em><a href="https://github.com/jbossws">GitHub</a></em> :-)</p>

<p>I've started by creating a <em>jbossws</em> organization on <em>GitHub</em>. Since the JBossWS project is actually a collection of multiple components each having its own lifecycle, I decided to create a repository for each of them into the organization.</p>

<p>A proper migration requires importing the whole svn repository history, of course; the easiest approach to achieve that is to rely on the <a href="https://import.github.com/new">GitHub importer</a>. The tool worked fine for me with the smallest repositories (for instance the <em>jbossws-api</em> and <em>jbossws-spi</em> ones), even if it took something like 2 hours for each import (but it's nice that you can let it run on background and be notified by email when the process is completed). Unfortunately, when letting the tool process big sections of the <em>JBossWS</em> <em>Subversion</em> repository (like the <em>jbossws-cxf</em> stack integration), weird import errors were eventually reported, so I had to figure out another way to perform the import.</p>

<p>The alternative approach that worked is based on <em>git-svn</em>. The first step is to build up a comprehensive author mapping file linking <em>svn</em> commit authors to <em>GitHub</em> users. I used the following <em>bash</em> command:</p>

<p><code class="language-plaintext highlighter-rouge">&amp;gt; svn log -q | awk -F &amp;#39;|&amp;#39; &amp;#39;/^r/ {sub(&amp;#34;^ &amp;#34;, &amp;#34;&amp;#34;, $2); sub(&amp;#34; $&amp;#34;, &amp;#34;&amp;#34;, $2); 
print $2&amp;#34; = &amp;#34;$2&amp;#34; &amp;lt;&amp;#34;$2&amp;#34;&amp;gt;&amp;#34;}&amp;#39; | sort -u &amp;gt; authors-transform.txt</code></p>

<p>Then I created a local <em>Git</em> repository from the Subversion sources with the following command:</p>

<p><code class="language-plaintext highlighter-rouge">&amp;gt; git svn clone --stdlayout --no-metadata -A authors-transform.txt http://anonsvn.jboss.org/repos/jbossws/stack/cxf /tmp/rep</code></p>

<p>The process still takes multiple hours and fails if a not-mapped user commit is found, but when it's completed you have a copy of all sources in a local <em>Git</em> repository that is almost ready to push. Almost… as I still had to deal with tags because they're fetched the same as branches by the command above.</p>

<p>I moved to the <em>/tmp/rep</em> directory and started by adding a remote repository link and pushing the master:</p>

<p><code class="language-plaintext highlighter-rouge">&amp;gt; git remote add origin https://github.com/jbossws/jbossws-cxf.git</code></p>

<p><code class="language-plaintext highlighter-rouge">&amp;gt; git push -u origin master</code></p>

<p>Then you'd have to manually create all the tags, but that's clearly unpractical if you have hundreds of them, so I googled a bit and ended up using the following two commands to generate the actual commands for pushing branches and tags respectively to the remote repository:</p>

<p><code class="language-plaintext highlighter-rouge">&amp;gt; printf &amp;#34;git push origin &amp;#34;; git show-ref | grep refs/remotes | grep -v 
&amp;#39;@&amp;#39; | grep -v remotes/tags | perl -ne &amp;#39;print 
&amp;#34;refs/remotes/$1:refs/heads/$1 &amp;#34; if m!refs/remotes/(.*)!&amp;#39;; echo</code></p>

<p><code class="language-plaintext highlighter-rouge">&amp;gt; printf &amp;#34;git push origin &amp;#34;; git show-ref | grep refs/remotes/tags | grep -v &amp;#39;@&amp;#39; | perl -ne &amp;#39;print &amp;#34;refs/remotes/tags/$1:refs/tags/$1 &amp;#34; if m!refs/remotes/tags/(.*)!&amp;#39;; echo</code></p>

<p>I only had to clean up the output of the first command a bit as the trunk branch was clearly not to be pushed (it's the master pushed previously) and I actually did not want to push some stale branches.</p>

<p>After having iterated the process above for all <em>JBossWS</em> components that failed the automatic import process, I finally had all the sources there at <em>GitHub</em>.</p>

<p>The final steps were to disable the issue tracker &amp; wiki on <em>GitHub</em> (we already use <em>JIRA</em> and have an equivalent to the wiki at <em>jboss.org</em>) and to invite proper users to join the Owner group for the organization as well as other specific groups that were needed.</p>

<p>A day was later spent on updating the <a href="http://jbossws-qa.jboss.org:8180/hudson/">continuous integration build environment</a> and the <a href="http://jbossws.jboss.org/">project home page</a> to point to the new repositories… but that's not that interesting to be described in details here ;-)</p>

<p><em><strong>Enjoy the new repos, fork JBossWS and feel free to submit pull requests with your patches!</strong></em></p>



                  </div><!-- end main -->
               </div>

    <div id="rightcolumn" class="column">

    <div class="projectpage-socialmedia">
        <span class="st_sharethis_large">&nbsp;</span>
        <span class="st_facebook_large">&nbsp;</span>
        <span class="st_twitter_large">&nbsp;</span>
        <span class="st_linkedin_large">&nbsp;</span>
        <span class="st_email_large">&nbsp;</span>
    </div>


    <div id="proj_quick-start">
        <h3>Useful Links</h3>
        <ul>
            <li><a href="/downloads-latest/">Download</a></li>
            <li><a href="/docs">Documentation</a></li>
            <li><a href="/blogs">Blog</a></li>
            <li><a href="https://issues.redhat.com/browse/JBWS">JIRA</a></li>
            <li><a href="https://github.com/jbossws">Code</a></li>
            <li><a href="https://github.com/jbossws/jbossws-cxf/discussions">Discussion</a></li>
        </ul>
    </div>

    <div class="clear"><br/></div>

    <div class="uploaded-img">

        <a href="https://www.ej-technologies.com/products/jprofiler/overview.html">

            <img width="180" alt="" height="75"
                 src="/img/logo_jprofiler01.gif"
                 style="margin:0 auto;"/>

        </a>
    </div>

    <h5>We use JProfiler for profiling</h5>

    <table>
        <tr>
            <td>
            </td>
        </tr>
    </table>


    <div>
        <a href="https://www.jboss.org/security.html">
            <div class="projectpage-sprite projectpage-sprite-securityimage">&nbsp;</div>
        </a>
    </div>
</div>

</div><!-- end wrapper-3 -->

</div><!-- end wrapper-content -->
<div style="clear: both;"></div>
</div><!-- end wrapper-2 -->
</div>
       <div id="site-info">
      <div>
      </div>

      <div class="footer">
         <div class="container" id="companyfooter">
            <div class="redhatlogo" style="text-align:center;">
               <div id="logospacer"></div>
               <a href="https://www.redhat.com/">
                  <img src="https://static.jboss.org/images/rhbar/redhatlogo.png">
               </a>
            </div>
         </div>
      </div>
   </div><!-- end site-info -->
</div><!-- end wrapper -->

    </body>
</html>
